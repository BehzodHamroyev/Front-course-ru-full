"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[870],{1870:(e,n,a)=>{a.r(n),a.d(n,{default:()=>F});var r,t=a(5893),o=a(4611),l=a(5443),i=a(1150);!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(r||(r={}));var u,c=a(7168),s=(0,c.hg)("profile/fetchProfileData",(function(e,n){return a=void 0,r=void 0,o=function(){var e,a,r,t;return function(e,n){var a,r,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(u){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(l=0)),l;)try{if(a=1,r&&(t=2&i[0]?r.return:i[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,i[1])).done)return t;switch(r=0,t&&(i=[2&i[0],t.value]),i[0]){case 0:case 1:t=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!t||i[1]>t[0]&&i[1]<t[3])){l.label=i[1];break}if(6===i[0]&&l.label<t[1]){l.label=t[1],t=i;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(i);break}t[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],r=0}finally{a=t=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(o){switch(o.label){case 0:e=n.extra,a=n.rejectWithValue,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.api.get("/profile")];case 2:if(!(r=o.sent()).data)throw new Error;return[2,r.data];case 3:return t=o.sent(),console.log(t),[2,a("error")];case 4:return[2]}}))},new((t=void 0)||(t=Promise))((function(e,n){function l(e){try{u(o.next(e))}catch(e){n(e)}}function i(e){try{u(o.throw(e))}catch(e){n(e)}}function u(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,i)}u((o=o.apply(a,r||[])).next())}));var a,r,t,o})),d=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.form},f=(0,c.hg)("profile/updateProfileData",(function(e,n){return a=void 0,t=void 0,l=function(){var e,a,t,o,l,i,u;return function(e,n){var a,r,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(u){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(l=0)),l;)try{if(a=1,r&&(t=2&i[0]?r.return:i[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,i[1])).done)return t;switch(r=0,t&&(i=[2&i[0],t.value]),i[0]){case 0:case 1:t=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!t||i[1]>t[0]&&i[1]<t[3])){l.label=i[1];break}if(6===i[0]&&l.label<t[1]){l.label=t[1],t=i;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(i);break}t[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],r=0}finally{a=t=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(c){switch(c.label){case 0:if(e=n.extra,a=n.rejectWithValue,t=n.getState,o=d(t()),console.log(o,"formdata"),(l=function(e){if(!e)return[r.NO_DATA];var n=e.first,a=e.lastname,t=e.age,o=e.country,l=[];return n&&a||l.push(r.INCORRECT_USER_DATA),t&&Number.isInteger(t)||l.push(r.INCORRECT_AGE),o||l.push(r.INCORRECT_COUNTRY),l}(o)).length)return[2,a(l)];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,e.api.put("/profile",o)];case 2:if(!(i=c.sent()).data)throw new Error;return[2,i.data];case 3:return u=c.sent(),console.log(u),[2,a([r.SERVER_ERROR])];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,n){function r(e){try{u(l.next(e))}catch(e){n(e)}}function i(e){try{u(l.throw(e))}catch(e){n(e)}}function u(n){var a;n.done?e(n.value):(a=n.value,a instanceof o?a:new o((function(e){e(a)}))).then(r,i)}u((l=l.apply(a,t||[])).next())}));var a,t,o,l})),v=function(){return v=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var t in n=arguments[a])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},v.apply(this,arguments)},p=(0,c.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:function(e,n){e.readonly=n.payload},cancelEdit:function(e){e.readonly=!0,e.validateErrors=void 0,e.form=e.data},updateProfile:function(e,n){e.form=v(v({},e.form),n.payload)}},extraReducers:function(e){e.addCase(s.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(s.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload})).addCase(s.rejected,(function(e,n){e.isLoading=!1,e.error=n.payload})).addCase(f.pending,(function(e){e.validateErrors=void 0,e.isLoading=!0})).addCase(f.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(f.rejected,(function(e,n){e.isLoading=!1,e.validateErrors=n.payload}))}}),h=p.actions,m=p.reducer,y=a(4809),g=a(6925),C=a(4002),R=a(71);!function(e){e.RUB="RUB",e.EUR="EUR",e.USD="USD"}(u||(u={}));var x=a(7294);var N,b=(0,x.memo)((function(e){var n=e.className,a=e.label,r=e.options,l=e.onChange,i=e.value,u=e.readonly,c=(0,x.useMemo)((function(){return null==r?void 0:r.map((function(e){return(0,t.jsx)("option",{className:"JkXz98qY",value:e.value,children:e.content},e.value)}))}),[r]);return(0,t.jsxs)("div",{className:(0,o.A)("cidfdn6H",{},[n]),children:[a&&(0,t.jsx)("span",{className:"G1uuf7Bp",children:"".concat(a,">")}),(0,t.jsx)("select",{disabled:u,className:"VOKOuKGo",value:i,onChange:function(e){l&&l(e.target.value)},children:c})]})})),E=[{value:u.RUB,content:u.RUB},{value:u.EUR,content:u.EUR},{value:u.USD,content:u.USD}],j=(0,x.memo)((function(e){var n=e.className,a=e.value,r=e.onChange,i=e.readonly,u=(0,l.$)().t,c=(0,x.useCallback)((function(e){null==r||r(e)}),[r]);return(0,t.jsx)(b,{className:(0,o.A)("",{},[n]),label:u("Укажите валюту"),options:E,value:a,onChange:c,readonly:i})}));!function(e){e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazahstan",e.Armenia="Armenia"}(N||(N={}));var O=[{value:N.Armenia,content:N.Armenia},{value:N.Russia,content:N.Russia},{value:N.Belarus,content:N.Belarus},{value:N.Kazakhstan,content:N.Kazakhstan},{value:N.Ukraine,content:N.Ukraine}],A=(0,x.memo)((function(e){var n=e.className,a=e.value,r=e.onChange,i=e.readonly,u=(0,l.$)().t,c=(0,x.useCallback)((function(e){null==r||r(e)}),[r]);return(0,t.jsx)(b,{className:(0,o.A)("",{},[n]),label:u("Укажите страну"),options:O,value:a,onChange:c,readonly:i})}));const T={ProfileCard:"wW9jgKKD",input:"ZTyX8_n9",loading:"t07ZxFGs",error:"i5YK3SSb",avatarWrapper:"bEFNSahN",editing:"DjTe7269"};var w=function(e){var n,a,r=e.className,i=e.data,u=e.isLoading,c=e.error,s=e.readonly,d=e.onChangeFirstname,f=e.onChangeLastname,v=e.onChangeAge,p=e.onChangeCity,h=e.onChangeAvatar,m=e.onChangeUsername,x=e.onChangeCountry,N=e.onChangeCurrency;console.log(i,"data");var b=(0,l.$)("profile").t;if(u)return(0,t.jsx)("div",{className:(0,o.A)(T.ProfileCard,(n={},n[T.loading]=!0,n),[r]),children:(0,t.jsx)(C.a,{})});if(c)return(0,t.jsx)("div",{className:(0,o.A)(T.ProfileCard,{},[r,T.error]),children:(0,t.jsx)(y.xv,{theme:y.lg.ERROR,title:b("Произошла ошибка при загрузке профиля"),text:b("Попробуйте обновить страницу"),align:y.PH.CENTER})});var E=((a={})[T.editing]=!s,a);return(0,t.jsx)("div",{className:(0,o.A)(T.ProfileCard,E,[r]),children:(0,t.jsxs)("div",{className:T.data,children:[(null==i?void 0:i.avatar)&&(0,t.jsx)("div",{className:T.avatarWrapper,children:(0,t.jsx)(R.q,{src:null==i?void 0:i.avatar})}),(0,t.jsx)(g.I,{value:null==i?void 0:i.first,placeholder:b("Ваше имя"),className:T.input,onChange:d,readonly:s}),(0,t.jsx)(g.I,{value:null==i?void 0:i.lastname,placeholder:b("Ваша фамилия"),className:T.input,onChange:f,readonly:s}),(0,t.jsx)(g.I,{value:null==i?void 0:i.age,placeholder:b("Ваш возраст"),className:T.input,onChange:v,readonly:s}),(0,t.jsx)(g.I,{value:null==i?void 0:i.city,placeholder:b("Город"),className:T.input,onChange:p,readonly:s}),(0,t.jsx)(g.I,{value:null==i?void 0:i.username,placeholder:b("Введите имя пользователя"),className:T.input,onChange:m,readonly:s}),(0,t.jsx)(g.I,{value:null==i?void 0:i.avatar,placeholder:b("Введите ссылку на аватар"),className:T.input,onChange:h,readonly:s}),(0,t.jsx)(j,{className:T.input,value:null==i?void 0:i.currency,onChange:N,readonly:s}),(0,t.jsx)(A,{className:T.input,value:null==i?void 0:i.country,onChange:x,readonly:s})]})})},P=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.isLoading},k=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.error},I=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.readonly},U=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.validateErrors},_=a(5461),S=a(7007),L=a(9161);const D={ProfilePageHeader:"FPJSgL1_",editBtn:"vP5lJqeW"};var B=function(e){var n=e.className,a=(0,l.$)("profile").t,r=(0,S.v9)(I),i=(0,_.T)(),u=(0,x.useCallback)((function(){i(h.setReadonly(!1))}),[i]),c=(0,x.useCallback)((function(){i(h.cancelEdit())}),[i]),s=(0,x.useCallback)((function(){i(f())}),[i]);return(0,t.jsxs)("div",{className:(0,o.A)(D.ProfilePageHeader,{},[n]),children:[(0,t.jsx)(y.xv,{title:a("Профиль")}),r?(0,t.jsx)(L.zx,{className:D.editBtn,theme:L.bn.OUTLINE,onClick:u,children:a("Редактировать")}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.zx,{className:D.editBtn,theme:L.bn.OUTLINE_RED,onClick:c,children:a("Отменить")}),(0,t.jsx)(L.zx,{className:D.saveBtn,theme:L.bn.OUTLINE,onClick:s,children:a("Сохранить")})]})]})},z={profile:m};const F=function(e){var n,a=e.className,u=(0,l.$)("profile").t,c=(0,_.T)(),f=(0,S.v9)(d),v=(0,S.v9)(P),p=(0,S.v9)(k),m=(0,S.v9)(I),g=(0,S.v9)(U),C=((n={})[r.SERVER_ERROR]=u("Серверная ошибка при сохранении"),n[r.INCORRECT_COUNTRY]=u("Некорректный регион"),n[r.NO_DATA]=u("Данные не указаны"),n[r.INCORRECT_USER_DATA]=u("Имя и фамилия обязательны"),n[r.INCORRECT_AGE]=u("Некорректный возраст"),n);(0,x.useEffect)((function(){c(s())}),[c]);var R=(0,x.useCallback)((function(e){c(h.updateProfile({first:e||""}))}),[c]),N=(0,x.useCallback)((function(e){c(h.updateProfile({lastname:e||""}))}),[c]),b=(0,x.useCallback)((function(e){c(h.updateProfile({city:e||""}))}),[c]),E=(0,x.useCallback)((function(e){c(h.updateProfile({age:Number(e||0)}))}),[c]),j=(0,x.useCallback)((function(e){c(h.updateProfile({username:e||""}))}),[c]),O=(0,x.useCallback)((function(e){c(h.updateProfile({avatar:e||""}))}),[c]),A=(0,x.useCallback)((function(e){c(h.updateProfile({currency:e}))}),[c]),T=(0,x.useCallback)((function(e){c(h.updateProfile({country:e}))}),[c]);return(0,t.jsx)(i.W,{reducers:z,removeAfterUnmount:!0,children:(0,t.jsxs)("div",{className:(0,o.A)("",{},[a]),children:[(0,t.jsx)(B,{}),(null==g?void 0:g.length)&&g.map((function(e){return(0,t.jsx)(y.xv,{theme:y.lg.ERROR,text:C[e]},e)})),(0,t.jsx)(w,{data:f,isLoading:v,error:p,readonly:m,onChangeFirstname:R,onChangeLastname:N,onChangeAge:E,onChangeCity:b,onChangeUsername:j,onChangeAvatar:O,onChangeCurrency:A,onChangeCountry:T})]})})}},1150:(e,n,a)=>{a.d(n,{W:()=>l});var r=a(5893),t=a(7294),o=a(7007),l=function(e){var n=e.children,a=e.reducers,l=e.removeAfterUnmount,i=(0,o.oR)(),u=(0,o.I0)();return(0,t.useEffect)((function(){return Object.entries(a).forEach((function(e){var n=e[0],a=e[1];i.reducerManager.add(n,a),u({type:"@INIT ".concat(n," reducer")})})),function(){l&&Object.entries(a).forEach((function(e){var n=e[0];e[1],i.reducerManager.remove(n),u({type:"@DESTROY ".concat(n," reducer")})}))}}),[]),(0,r.jsx)(r.Fragment,{children:n})}},71:(e,n,a)=>{a.d(n,{q:()=>l});var r=a(5893),t=a(4611),o=a(7294);var l=function(e){var n=e.className,a=e.src,l=e.size,i=e.alt,u=(0,o.useMemo)((function(){return{width:l||100,height:l||100}}),[l]);return(0,r.jsx)("img",{src:a,alt:i,style:u,className:(0,t.A)("ZqPdwJxd",{},[n])})}},6925:(e,n,a)=>{a.d(n,{I:()=>i});var r=a(5893),t=a(4611),o=a(7294);var l=function(){return l=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var t in n=arguments[a])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},l.apply(this,arguments)},i=(0,o.memo)((function(e){var n=e.className,a=e.value,i=e.onChange,u=e.type,c=void 0===u?"text":u,s=e.placeholder,d=e.autofocus,f=e.readonly,v=function(e,n){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(r=Object.getOwnPropertySymbols(e);t<r.length;t++)n.indexOf(r[t])<0&&Object.prototype.propertyIsEnumerable.call(e,r[t])&&(a[r[t]]=e[r[t]])}return a}(e,["className","value","onChange","type","placeholder","autofocus","readonly"]),p=(0,o.useRef)(null),h=(0,o.useState)(!1),m=h[0],y=h[1],g=(0,o.useState)(0),C=g[0],R=g[1],x=m&&!f;return(0,o.useEffect)((function(){var e;d&&(y(!0),null===(e=p.current)||void 0===e||e.focus())}),[d]),{}.fTN1PnWu=f,(0,r.jsxs)("div",{className:(0,t.A)("LuFDUWoP",{},[n]),children:[s&&(0,r.jsx)("div",{className:"emAQQ85i",children:"".concat(s,">")}),(0,r.jsxs)("div",{className:"y1GiFC_L",children:[(0,r.jsx)("input",l({ref:p,type:c,value:a,onChange:function(e){null==i||i(e.target.value),R(e.target.value.length)},className:"LVdIPwcx",onFocus:function(){y(!0)},onBlur:function(){y(!1)},onSelect:function(e){var n;R((null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.selectionStart)||0)},readOnly:f},v)),x&&(0,r.jsx)("span",{className:"lqMFGBuL",style:{left:"".concat(9*C,"px")}})]})]})}))},4809:(e,n,a)=>{a.d(n,{xv:()=>s,PH:()=>u,yH:()=>c,lg:()=>i});var r=a(5893),t=a(4611),o=a(7294);const l={title:"ikI7VPeL",text:"uNJeeCm1",error:"F9oLXAK4",left:"dBqPIG8f",right:"j4UBrvei",center:"iJw6m2iu",size_m:"AOVZBfas",size_l:"U6JpO11Q"};var i,u,c;!function(e){e.PRIMARY="primary",e.ERROR="error"}(i||(i={})),function(e){e.RIGHT="right",e.LEFT="left",e.CENTER="center"}(u||(u={})),function(e){e.M="size_m",e.L="size_l"}(c||(c={}));var s=(0,o.memo)((function(e){var n,a=e.className,o=e.text,s=e.title,d=e.theme,f=void 0===d?i.PRIMARY:d,v=e.align,p=void 0===v?u.LEFT:v,h=e.size,m=void 0===h?c.M:h,y=((n={})[l[f]]=!0,n[l[p]]=!0,n[l[m]]=!0,n);return(0,r.jsxs)("div",{className:(0,t.A)(l.Text,y,[a]),children:[s&&(0,r.jsx)("p",{className:l.title,children:s}),o&&(0,r.jsx)("p",{className:l.text,children:o})]})}))},5461:(e,n,a)=>{a.d(n,{T:()=>t});var r=a(7007),t=function(){return(0,r.I0)()}}}]);